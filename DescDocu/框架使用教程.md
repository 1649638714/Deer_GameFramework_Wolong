## 		Deer_GameFramework_Wolong框架使用教程

## 1.部署HybridCLR（Wolong）环境

1. github地址：[It-Life/Deer_GameFramework_Wolong: 基于GameFramework框架衍生的一个Wolong (huatuo)热更框架,接入luban配表工具 (github.com)](https://github.com/It-Life/Deer_GameFramework_Wolong)

![img](https://github.com/It-Life/Deer_GameFramework_Wolong/blob/2020.3.33/DescDocu/%E6%95%99%E7%A8%8B/%E6%95%99%E7%A8%8B1.jpg?raw=true)

2. 克隆完项目可以看到【HybridCLRData】目录

![img](https://github.com/It-Life/Deer_GameFramework_Wolong/blob/2020.3.33/DescDocu/%E6%95%99%E7%A8%8B/%E6%95%99%E7%A8%8B2.jpg?raw=true)

进入目录找到init_local_il2cpp_data.bat 批处理文件 双击克隆出最新的Wolong il2cpp

![img](https://github.com/It-Life/Deer_GameFramework_Wolong/blob/2020.3.33/DescDocu/%E6%95%99%E7%A8%8B/%E6%95%99%E7%A8%8B3.jpg?raw=true)

3. 进入 ..\HybridCLRData\LocalIl2CppData\il2cpp\libil2cpp\huatuo\interpreter 目录删除MethodBridge_Arm64.cpp、MethodBridge_General32.cpp、MethodBridge_General64.cpp 三个桥接文件

![img](https://github.com/It-Life/Deer_GameFramework_Wolong/blob/2020.3.33/DescDocu/%E6%95%99%E7%A8%8B/%E6%95%99%E7%A8%8B4.jpg?raw=true)

4. 打开工程找到工具栏【HybridCLR】重新生成三份桥接文件

![img](https://github.com/It-Life/Deer_GameFramework_Wolong/blob/2020.3.33/DescDocu/%E6%95%99%E7%A8%8B/%E6%95%99%E7%A8%8B5.jpg?raw=true)

## 2.构建AB包

1. 所有热更代码 及aot代码都会放到 assembly.bat ab包里，Assembly文件夹在GF里的ResourceEditor 工具里不用从AssetList移动到ResourceList里，每次构建ab资源都会是最新的。其他ab文件规则不变，还按照之前gf规则移动过去。

![img](https://github.com/It-Life/Deer_GameFramework_Wolong/blob/2020.3.33/DescDocu/%E6%95%99%E7%A8%8B/%E6%95%99%E7%A8%8B6.jpg?raw=true)

2. 我们打开GF里的ResourceBuilder 工具，点击StartBuildResource按钮

![img](https://github.com/It-Life/Deer_GameFramework_Wolong/blob/2020.3.33/DescDocu/%E6%95%99%E7%A8%8B/%E6%95%99%E7%A8%8B7.jpg?raw=true)

3. 构建完成在StreamingAssets 目录里可以看到我们构建的资源，目前我们是单机包所以AssetsHotfix、AssetsNative都会到StreamingAssets 目录。比如我们打热更包的时候其中AssetsNative里的资源为包体资源也会到StreamingAssets目录，AssetsHotfix目录里的资源则不会到此目录。

![图形用户界面, 文本  描述已自动生成](https://github.com/It-Life/Deer_GameFramework_Wolong/blob/2020.3.33/DescDocu/%E6%95%99%E7%A8%8B/%E6%95%99%E7%A8%8B8.jpg?raw=true)

 

## 3.生成Luban配表

1. 找到目录 ..\ LubanTools\DesignerConfigs ,双击StreamingAssets_BuildConfig_Wolong.bat 批处理文件，会生成Config代码及bin文件，其中bin文件生成到StreamingAssets，LubanConfig文件夹以及ConfigVersion.xml文件。

![img](https://github.com/It-Life/Deer_GameFramework_Wolong/blob/2020.3.33/DescDocu/%E6%95%99%E7%A8%8B/%E6%95%99%E7%A8%8B9.jpg?raw=true)

![img](https://github.com/It-Life/Deer_GameFramework_Wolong/blob/2020.3.33/DescDocu/%E6%95%99%E7%A8%8B/%E6%95%99%E7%A8%8B10.jpg?raw=true)

## 4.Build出包

1. 找到并打开BuildSetting界面

![img](https://github.com/It-Life/Deer_GameFramework_Wolong/blob/2020.3.33/DescDocu/%E6%95%99%E7%A8%8B/%E6%95%99%E7%A8%8B11.jpg?raw=true)

点击build到对应出包目录。

2. 出包后，我们就可以看到出包可以正常打开 

## 5.测试热更

1. 测试热更资源

2. 测试热更代码

   1和2找到UILoginForm.prefab 预制体打开，新建一个按钮。打开UILoginForm.cs 脚本，把刚才的按钮逻辑写完，然后打印输出。

3. 回到构建ab包，打开gf的ResourceBuilder工具，点击StartBuildResource按钮，构建完成后我们找到StreamingAssets目录下的UILoginForm.bat ab资源复制到刚才出包目录下的StreamingAssets 下对应目录，重新打开exe包，可以看到界面变化。